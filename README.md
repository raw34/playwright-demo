# Playwright æ¼”ç¤ºé¡¹ç›®

åŸºäº TypeScript æ„å»ºçš„å…¨é¢ Playwright E2E æµ‹è¯•æ¡†æ¶ï¼Œé‡‡ç”¨æµ‹è¯•è‡ªåŠ¨åŒ–æœ€ä½³å®è·µã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ­ **Playwright** - ç°ä»£æµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·
- ğŸ”· **TypeScript** - ç±»å‹å®‰å…¨çš„æµ‹è¯•å¼€å‘  
- ğŸ“ **é¡µé¢å¯¹è±¡æ¨¡å¼** - å¯ç»´æŠ¤çš„æµ‹è¯•æ¶æ„
- ğŸ§ª **å¤šç§æµ‹è¯•ç±»å‹** - E2Eã€API å’Œç»„ä»¶æµ‹è¯•
- ğŸ”§ **ä»£ç è´¨é‡** - ESLint + Prettier é…ç½®
- ğŸš€ **CI/CD å°±ç»ª** - GitHub Actions å·¥ä½œæµ
- ğŸ“Š **ä¸°å¯ŒæŠ¥å‘Š** - åŒ…å«æˆªå›¾å’Œè§†é¢‘çš„ HTML æŠ¥å‘Š
- ğŸ¦Š **MetaMask ç­¾å** - è‡ªåŠ¨åŒ–é’±åŒ…ç­¾åæµ‹è¯•ï¼ˆæ— éœ€äººå·¥ä»‹å…¥ï¼‰
- â›“ï¸ **åŒºå—é“¾é›†æˆ** - æ”¯æŒ Arbitrum One å’Œ Sepolia æµ‹è¯•ç½‘
- ğŸ” **æ¶ˆæ¯ç­¾åéªŒè¯** - EIP-191 å’Œ EIP-712 ç­¾åæ”¯æŒ

## é¡¹ç›®ç»“æ„

```
playwright-demo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/              # é¡µé¢å¯¹è±¡æ¨¡å¼ç±»
â”‚   â”‚   â”œâ”€â”€ base.page.ts    # åŒ…å«é€šç”¨æ–¹æ³•çš„åŸºç¡€é¡µé¢
â”‚   â”‚   â”œâ”€â”€ github.page.ts  # GitHub é¡µé¢æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ demo-sites.page.ts # æ¼”ç¤ºç½‘ç«™é¡µé¢æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ bilibili.page.ts # Bilibili é¡µé¢æ“ä½œ
â”‚   â”‚   â””â”€â”€ metamask-mock.page.ts # MetaMask æ¨¡æ‹Ÿäº¤äº’
â”‚   â”œâ”€â”€ tests/              # æµ‹è¯•æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ e2e/           # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ github.test.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ demo-sites.test.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ bilibili.test.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ arbitrum-transfer.test.ts # Arbitrum ETH è½¬è´¦æµ‹è¯•
â”‚   â”‚   â”‚   â””â”€â”€ metamask-auto-signing.test.ts # MetaMask è‡ªåŠ¨ç­¾åæµ‹è¯•
â”‚   â”‚   â””â”€â”€ api/           # API æµ‹è¯•
â”‚   â”‚       â”œâ”€â”€ github-api.test.ts
â”‚   â”‚       â””â”€â”€ bilibili-api.test.ts
â”‚   â”œâ”€â”€ fixtures/          # æµ‹è¯•æ•°æ®å’Œå¤¹å…·
â”‚   â”‚   â”œâ”€â”€ github.data.ts
â”‚   â”‚   â”œâ”€â”€ demo.data.ts
â”‚   â”‚   â””â”€â”€ bilibili.data.ts
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ helpers.ts
â”‚   â”‚   â”œâ”€â”€ blockchain.ts  # åŒºå—é“¾äº¤äº’å·¥å…·
â”‚   â”‚   â”œâ”€â”€ message-signing.ts # æ¶ˆæ¯ç­¾åå·¥å…·
â”‚   â”‚   â””â”€â”€ backend-mock.ts # åç«¯éªŒè¯æ¨¡æ‹Ÿ
â”‚   â””â”€â”€ config/            # è®¾ç½®å’Œæ¸…ç†é…ç½®
â”‚       â”œâ”€â”€ global-setup.ts
â”‚       â”œâ”€â”€ global-teardown.ts
â”‚       â””â”€â”€ blockchain.config.ts # åŒºå—é“¾é…ç½®
â”œâ”€â”€ .github/workflows/     # CI/CD é…ç½®
â”œâ”€â”€ playwright.config.ts   # Playwright é…ç½®æ–‡ä»¶
â”œâ”€â”€ tsconfig.json         # TypeScript é…ç½®
â””â”€â”€ package.json          # ä¾èµ–å’Œè„šæœ¬
```

## å¿«é€Ÿå¼€å§‹

1. **å®‰è£…ä¾èµ–**:
   ```bash
   yarn install
   ```

2. **å®‰è£…æµè§ˆå™¨**:
   ```bash
   yarn install:browsers
   ```

3. **è¿è¡Œæµ‹è¯•**:
   ```bash
   yarn test
   ```

## å¯ç”¨è„šæœ¬

- `yarn test` - è¿è¡Œæ‰€æœ‰æµ‹è¯•
- `yarn test:headed` - ä»¥æœ‰å¤´æ¨¡å¼è¿è¡Œæµ‹è¯•
- `yarn test:debug` - ä»¥è°ƒè¯•æ¨¡å¼è¿è¡Œæµ‹è¯•
- `yarn test:ui` - ä½¿ç”¨ Playwright UI è¿è¡Œæµ‹è¯•
- `yarn test:report` - æ˜¾ç¤ºæµ‹è¯•æŠ¥å‘Š
- `yarn test:codegen` - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆæµ‹è¯•
- `yarn lint` - æ£€æŸ¥ä»£ç è´¨é‡
- `yarn lint:fix` - ä¿®å¤ä»£ç è§„èŒƒé—®é¢˜
- `yarn format` - ä½¿ç”¨ Prettier æ ¼å¼åŒ–ä»£ç 
- `yarn typecheck` - æ£€æŸ¥ TypeScript ç±»å‹

## é…ç½®

### ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶å¹¶é…ç½®ä»¥ä¸‹å˜é‡ï¼š

```bash
# åŸºç¡€é…ç½®
BASE_URL=http://localhost:3000
API_BASE_URL=https://api.example.com

# åŒºå—é“¾é…ç½®
RPC_URL=https://sepolia.infura.io/v3/YOUR_KEY  # æˆ– Arbitrum RPC
CHAIN_ID=11155111  # Sepolia: 11155111, Arbitrum One: 42161
PRIVATE_KEY=0x...  # æµ‹è¯•é’±åŒ…ç§é’¥
RECIPIENT_ADDRESS=0x...  # æ¥æ”¶åœ°å€
```

### æµ‹è¯•æ•°æ®

æµ‹è¯•æ•°æ®åœ¨ `src/fixtures/test-data.ts` ä¸­ç®¡ç†ï¼ŒåŒ…å«ï¼š
- GitHub API æµ‹è¯•æ•°æ®ï¼ˆä»“åº“ä¿¡æ¯ã€æœç´¢æŸ¥è¯¢ç­‰ï¼‰
- åŸºç¡€æ¼”ç¤ºæµ‹è¯•æ•°æ®ï¼ˆç™»å½•å‡­æ®ã€æµ‹è¯• URL ç­‰ï¼‰

## æµ‹è¯•ç”¨ä¾‹è¯´æ˜

### åŒºå—é“¾æµ‹è¯•

#### MetaMask è‡ªåŠ¨ç­¾åæµ‹è¯• (`metamask-auto-signing.test.ts`)
- âœ… **å®Œæ•´ç­¾åæµç¨‹éªŒè¯** - æ— éœ€äººå·¥ä»‹å…¥çš„è‡ªåŠ¨åŒ–ç­¾å
- ğŸ”’ **æ•°æ®ç¯¡æ”¹æ£€æµ‹** - éªŒè¯ç­¾åæ•°æ®çš„å®Œæ•´æ€§
- â° **è¿‡æœŸç­¾åæ‹’ç»** - é˜²é‡æ”¾æ”»å‡»æœºåˆ¶
- ğŸ‘¤ **ç­¾åè€…æƒé™éªŒè¯** - æƒé™æ§åˆ¶éªŒè¯
- ğŸŒ **API ç«¯ç‚¹é›†æˆ** - åç«¯éªŒè¯é›†æˆ

#### Arbitrum è½¬è´¦æµ‹è¯• (`arbitrum-transfer.test.ts`)
- **ETH è½¬è´¦åŠŸèƒ½** - åœ¨ Arbitrum One æˆ– Sepolia ä¸Šæ‰§è¡Œè½¬è´¦
- **äº¤æ˜“ç¡®è®¤éªŒè¯** - éªŒè¯äº¤æ˜“æˆåŠŸå’Œä½™é¢å˜åŒ–
- **ç¯å¢ƒé…ç½®åˆ‡æ¢** - æ”¯æŒæµ‹è¯•ç½‘å’Œä¸»ç½‘åˆ‡æ¢

### å¸¸è§„ E2E æµ‹è¯•

#### GitHub E2E æµ‹è¯• (`github.test.ts`)
- **GitHub é¦–é¡µè®¿é—®éªŒè¯** - æµ‹è¯• GitHub ä¸»é¡µåŠ è½½å’Œæ ‡é¢˜éªŒè¯
- **GitHub Logo éªŒè¯** - éªŒè¯ GitHub Logo æ˜¾ç¤º
- **é¡µé¢åŸºæœ¬ç»“æ„éªŒè¯** - éªŒè¯é¡µé¢å“åº”å’ŒåŸºæœ¬å†…å®¹

#### æ¼”ç¤ºç½‘ç«™ E2E æµ‹è¯• (`demo-sites.test.ts`)
- **Example.com å†…å®¹éªŒè¯** - éªŒè¯ç¤ºä¾‹ç½‘ç«™çš„åŸºæœ¬åŠŸèƒ½
- **HTTP API å“åº”æµ‹è¯•** - æµ‹è¯• API çš„ JSON å“åº”
- **è¡¨å•äº¤äº’æµ‹è¯•** - æµ‹è¯•ç™»å½•è¡¨å•çš„å¡«å†™å’Œæäº¤
- **æ— æ•ˆç™»å½•å‡­æ®æµ‹è¯•** - æµ‹è¯•é”™è¯¯ç™»å½•å¤„ç†
- **é¡µé¢æˆªå›¾åŠŸèƒ½** - æ¼”ç¤ºé¡µé¢æˆªå›¾åŠŸèƒ½
- **å“åº”æ—¶é—´æµ‹è¯•** - æµ‹è¯•ç½‘ç«™åŠ è½½æ€§èƒ½

#### Bilibili E2E æµ‹è¯• (`bilibili.test.ts`)
- **Bilibili é¦–é¡µè®¿é—®** - æµ‹è¯• Bilibili ç½‘ç«™è®¿é—®
- **æœç´¢åŠŸèƒ½æµ‹è¯•** - éªŒè¯æœç´¢åŠŸèƒ½
- **è§†é¢‘æ’­æ”¾æµ‹è¯•** - æµ‹è¯•è§†é¢‘é¡µé¢åŠ è½½

### API æµ‹è¯• (`github-api.test.ts`)
- **GitHub ä»“åº“ä¿¡æ¯è·å–** - é€šè¿‡ API è·å–ä»“åº“åŸºæœ¬ä¿¡æ¯
- **ä»“åº“æœç´¢åŠŸèƒ½** - æµ‹è¯• GitHub æœç´¢ API
- **ç¼–ç¨‹è¯­è¨€åˆ†å¸ƒæŸ¥è¯¢** - è·å–ä»“åº“çš„ç¼–ç¨‹è¯­è¨€ç»Ÿè®¡
- **README æ–‡ä»¶è·å–** - è·å–ä»“åº“çš„ README å†…å®¹
- **æäº¤å†å²è·å–** - è·å–ä»“åº“çš„æäº¤è®°å½•
- **å‘å¸ƒç‰ˆæœ¬ä¿¡æ¯** - è·å–ä»“åº“çš„ Release ä¿¡æ¯
- **é”™è¯¯å¤„ç†éªŒè¯** - æµ‹è¯• API é”™è¯¯å“åº”å¤„ç†

### é¡µé¢å¯¹è±¡æ¨¡å¼
- **BasePage** - æä¾›é€šç”¨çš„é¡µé¢æ“ä½œæ–¹æ³•
- **GitHubPage** - å°è£… GitHub ç½‘ç«™çš„æ“ä½œ
- **DemoSitesPage** - å°è£…æ¼”ç¤ºç½‘ç«™çš„æ“ä½œ

## æœ€ä½³å®è·µ

- ä½¿ç”¨é¡µé¢å¯¹è±¡æ¨¡å¼ç¼–å†™å¯ç»´æŠ¤çš„æµ‹è¯•
- åˆ©ç”¨ TypeScript å®ç°ç±»å‹å®‰å…¨
- é€‰æ‹©ç¨³å®šå¯é çš„æµ‹è¯•ç›®æ ‡ç½‘ç«™
- ä½¿ç”¨æœ‰æ„ä¹‰çš„æµ‹è¯•æè¿°
- æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†å’Œæ–­è¨€
- éµå¾ªæ—¢å®šçš„ä»£ç é£æ ¼æŒ‡å—

## è´¡çŒ®æŒ‡å—

1. éµå¾ªç°æœ‰çš„ä»£ç é£æ ¼
2. ä¸ºæ–°åŠŸèƒ½æ·»åŠ æµ‹è¯•
3. æäº¤å‰è¿è¡Œä»£ç æ£€æŸ¥å’Œç±»å‹æ£€æŸ¥
4. ä½¿ç”¨çº¦å®šå¼æäº¤æ¶ˆæ¯

## è®¸å¯è¯

MIT